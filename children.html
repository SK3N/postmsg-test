<!DOCTYPE html>
<html lang="ja">

  <head>
    <meta charset="UTF-8" />
    <title>Child - postMessageテスト</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 2rem;
      }

      input {
        width: 100%;
        padding: 0.5rem;
        margin-top: 1rem;
      }
    </style>
  </head>

  <body>
    <h1>Child Frame</h1>
    <p>ここは iframe 内です</p>

    <label for="tracking">トラッキングコード：</label>
    <input type="text" id="tracking" name="tracking" placeholder="未入力" />

    <script>
      window.addEventListener('message', function (event) {
        console.log("受信：", event.origin, event.data);

        // 必要に応じて origin チェック
        // if (event.origin !== "https://sk3n.github.io") return;

        const data = event.data;
        const input = document.getElementById("tracking");

        // 任意のキーの値（ここでは gad_source）を優先表示
        /*if (data.gad_source) {
          input.value = data.gad_source;
        } else {
          input.value = "受信データ: " + JSON.stringify(data);
        }*/
        input.value = "受信データ: " + JSON.stringify(data);
      });
    </script>
  </body>

</html>