<!DOCTYPE html>
<html lang="ja">

  <head>
    <meta charset="UTF-8">
    <title>親ページ</title>
    <style>
      .parent {
        max-width: 768px;
        margin: 2rem auto;
      }
    </style>
  </head>

  <body>
    <div class="parent">
      <h1>親ページ</h1>
      <button onclick="sendMessage()">iframeにメッセージ送信</button>
      <iframe id="child-iframe" src="https://potsmsg-test.netlify.app/children.html" width="100%" height="600" style="border:1px solid #ccc;"></iframe>

      <script>
        window.addEventListener('DOMContentLoaded', () => {
          const iframe = document.getElementById('child-iframe');

          // 送るデータ
          const trackingData = {
            gclid: 'EXAMPLE-GCLID',
            traffic_source: 'google',
          };

          // iframeが読み込まれてから postMessage 送信
          iframe.onload = () => {
            iframe.contentWindow.postMessage(trackingData, 'https://potsmsg-test.netlify.app');
          };
        });
      </script>
    </div>
  </body>

</html>